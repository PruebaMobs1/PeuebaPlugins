CPrepareModelSomar:
  Skills:
  - model{mid=CatapultaSomarfinal;n="Somar Catapult";ride=true}
# - skill{s=CrearVarPriori}
  - delay 10
  - skill{s=InvocarReclutador} #para invocar al reclutador si no esta creado{se debe utilizar: compareValues y su placeholder:<caster.type>}
  - skill{s=obtenerNevaVarPriori} @Self
  - delay 10
  - setvariable{var=caster.solds;t=string;value="false"}
#  - setvariable{var=caster.etapaSolds;t=string;value="sinSolds"}
  - setvariable{var=caster.sold1;t=String;value="false"}
  - delay 10
  - setvariable{var=caster.sold2;t=String;value="false"}
  - delay 10
  - setvariable{var=caster.sold3;t=String;value="false"}
#  - sudoparent @NearestPlayer
  - setvariable{var=caster.cicloDisp;t=String;value="false"}
MuerteCatapulta:
  Skills:
  - skill{s=desocuparCatapulteros} @LivingInWorld
  - skill{s=restarVariabPGlobal}
  - skill{s=AvisOrdenaVariabP} @LivingInWorld

InvocarReclutador:
  Conditions:
  - variableEquals{var=world.catapultas;val=-1}
  Skills:
  - message{m="No Exist√≠a reclutador"} @NearestPlayer
  - summon{type=reclutadorSomarCatapult;amount=1;radius=4} @Self

ObtenerVarPriori:
  Skills:
  - variableadd{var=world.priori;t=Integer;a=1}
  - setvariable{var=caster.priori;type=INTEGER;value=<world.var.priori>}

Pruebas:
  Skills:
#  - msg{m="Priori statica para catapultas <world.var.catapultas>, estancia prueba> <caster.stance>"} @NearestPlayer
  - message{m="Posc de jugador <target.var.posc>"} @NearestPlayer
#   - setFaction{faction=Somar} @NearestPlayer

Disparar:
  Skills:
    - skill{s=lanzarBloque}
#CargarBloque:

lanzarBloque:
  Cooldown: 15
  Skills:
    - state{mid=CatapultaSomarfinal;s=animationLanzarBloque3} @Self
#    - message{m="disparando"} @NearestPlayer
    - delay 55
    - projectile{bullet=block;material=STONE;vO=1.3;g=0.17;v=21;syo=15;sfo=1.8;mr=500;int=0.001;onHitBlockSkill=explocion;dd=300} @Forward{a=10}

ContornoVariabs: 
  Skills:
  - skill{s=MarcarDerecha} @LivingInCone{a=120;r=5;rot=270}
  - skill{s=MarcarIzquierda} @LivingInCone{a=120;r=5;rot=60}
  - skill{s=MarcarAtras} @LivingInCone{a=30;r=12;rot=190}
  - skill{s=MarcarLejos} @EIRR{min=8;max=15}
  - skill{s=MarcarMuylejos} @EIRR{min=16;max=20}

MarcarDerecha:
  TargetConditions:
  - (isMythicMob true || isPlayer true) true 
  Skills:
  - setvariable{var=target.posc;t=string;value="derecha"}

MarcarIzquierda:
  TargetConditions:
  - (isMythicMob true || isPlayer true) true 
  Skills:
  - setvariable{var=target.posc;t=string;value="izquierda"}

MarcarAtras:
  TargetConditions:
  - (isMythicMob true || isPlayer true) true 
  Skills:
  - setvariable{var=target.posc;t=string;value="atras"}

MarcarLejos:
  TargetConditions:
  - (isMythicMob true || isPlayer true) true 
  Skills:
  - setvariable{var=target.posc;t=string;value="lejos"}

MarcarMuylejos:
  TargetConditions:
  - (isMythicMob true || isPlayer true) true 
  Skills:
  - setvariable{var=target.posc;t=string;value="Muylejos"}

Accion:
  TriggerConditions:
  - variableEquals{key=target.posc;value="derecha"} Cast GirarDerecha
  - variableEquals{key=target.posc;value="izquierda"} Cast GirarIzquierda
  - variableEquals{key=target.posc;value="atras"} Cast Disparar
#    - variableEquals{key=target.posc;value="lejos"} true
  Skills:
    - cancelevent
    - message{m="Priori de catapulta <caster.var.priori>"} @NearestPlayer #temporal para ver ajuste de prioridad por catapulta
CfiltrarDano:
  TriggerConditions:
    - (itemissimilar{item=iron_axe} || itemissimilar{item=stone_axe} || itemissimilar{item=diamond_axe} 
      || itemissimilar{item=golden_axe} || itemissimilar{item=netherite_axe}) orElseCast Accion
  Skills:
GirarDerecha:
  Skills:
    - cancelevent
    - message{m="interactuandoD"} @NearestPlayer
    - setrotation{relative=true;pitch=0;yaw=15} @Self
GirarIzquierda:
  Skills:
    - cancelevent
    - message{m="interactuandoI"} @NearestPlayer
    - setrotation{relative=true;pitch=0;yaw=-15} @Self
explocion:
  Skills:
    - explosion{fire=true;y=10;bd=true} @Origin
    - effect:particles @RandomLocationsNearOrigin{r=4;a=7}
    - delay 10
    - throw{velocity=15;velocityY=5} @EntitiesNearOrigin{r=7}
    - effect:particles @RandomLocationsNearOrigin{r=10;a=20}
montarCtp:
  Skills:
    - mountmodel{mid=CatapultaSomarfinal;mode=walking;driver=false;pbone=asientoprinc,asientoIzq,asientoDere}
soldEmpjCtp:
  Skills:
    - dismountall{mid=CatapultaSomarfinal;p=asientoprinc,asientoIzq,asientoDere;sync=true} @self
soldEmpjCtpDere:
  Skills:
    - mountmodel{mid=CatapultaSomarfinal;mode=walking;driver=false;pbone=empujar_posc_Dere}
soldEmpjCtpIzq:
  Skills:
    - mountmodel{mid=CatapultaSomarfinal;mode=walking;driver=false;pbone=empujar_posc_Izq}
DesmontarCtp:
  Skills:
    - dismountall{mid=CatapultaSomarfinal;p=asientoprinc,asientoIzq,asientoDere;sync=true} @self
DesmontarIzqCtp:
  Skills:
    - dismountall{mid=CatapultaSomarfinal;p=asientoIzq;sync=true} @self
DesmontarDereCtp:
  Skills:
    - dismountall{mid=CatapultaSomarfinal;p=asientoDere;sync=true} @self

MarcCatapult1:
  Conditions:
#    - variableEquals{var=target.catapulta;t=INTEGER;value=0}
  - variableEquals{var=caster.sold1;t=String;value="false"} 
  - variableEquals{var=caster.priori;value=<world.var.tempPriori>}
  TargetConditions:
  - isMythicMob true
  - variableisset{var=caster.catapulta;t=INTEGER}
  - variableEquals{var=target.catapulta;t=INTEGER;val=0}
  Skills:
#    - setvariable{var=caster.sold1;t=String;value="reclutando"}
  - message{m="&a Soldado - 1 por reclutar"} @NearestPlayer
  - setvariable{var=target.catapultuuid;t=String;value="<caster.uuid>"}
  - sudoSkill{s=reportarseACatapult1}
  - delay 3
  - setvariable{var=target.catapulta;t=INTEGER;value=1}
  - sudoSkill{s=IrACataputa}
  - setFaction{faction=SomarCatapultero}
  - projectile{bullet=block;material=STONE}
  - delay 20
  - sudoSkill{s=PosicSoldCatapultero}
  - clearthreat @Self
  - setvariable{var=caster.cicloDisp;t=String;value="llamarCatapults"}
#    - variableadd{var=world.var.tempPriori;a=1} @Self
MarcCatapult2:
  Conditions:
  - variableEquals{var=caster.priori;value=<world.var.tempPriori>}
  - variableEquals{var=caster.sold2;t=String;value="false"} orElseCast MarcCatapult1
#    - variableEquals{var=target.catapulta;t=INTEGER;value=0}
  TargetConditions:
  - isMythicMob true
  - variableisset{var=caster.catapulta;t=INTEGER}
  - variableEquals{var=target.catapulta;t=INTEGER;val=0}
  Skills:
#    - setvariable{var=caster.sold2;t=String;value="reclutando"}
  - message{m="&a Soldado - 2 por reclutar"} @NearestPlayer
  - setvariable{var=target.catapultuuid;t=String;value="<caster.uuid>"}
  - sudoSkill{s=reportarseACatapult2}
  - delay 10
  - setvariable{var=target.catapulta;t=INTEGER;value=2}
  - sudoSkill{s=IrACataputa}
  - setFaction{f=SomarCatapultero}
  - projectile{bullet=block;material=STONE}
  - delay 20
  - sudoSkill{s=PosicSoldCatapultero}
  - clearthreat @Self
MarcCatapult3:
  Conditions:
  - variableEquals{var=caster.priori;value=<world.var.tempPriori>}
  - variableEquals{var=caster.sold3;t=String;value="false"} orElseCast MarcCatapult2
# - variableEquals{var=target.catapulta;t=INTEGER;value=0}
  TargetConditions:
  - isMythicMob true
  - variableisset{var=caster.catapulta;t=INTEGER} true
  - variableEquals{var=target.catapulta;t=INTEGER;val=0}
  Skills:
#  - setvariable{var=caster.sold3;t=String;value="reclutando"}
  - message{m="&a Soldado - 3 por reclutar"} @NearestPlayer
  - setvariable{var=target.catapultuuid;t=String;value="<caster.uuid>"} 
  - sudoSkill{s=reportarseACatapult3} 
  - delay 5
  - setvariable{var=target.catapulta;t=INTEGER;value=3} 
  - sudoSkill{s=IrACataputa}
  - setFaction{f=SomarCatapultero}
  - projectile{bullet=block;material=STONE}
  - delay 20
  - sudoSkill{s=PosicSoldCatapultero}
  - clearthreat @Self

desocuparCatapulteros:
  TargetConditions:
  - isMythicMob
  - variableisset{var=target.catapultuuid}
  - variableEquals{var=target.catapultuuid;val=<caster.uuid>}
  Skills:
  - variableUnset{var=target.catapultuuid}
  - setvariable{var=target.catapulta;t=Integer;value=0}
  - projectile{bullet=block;material=STONE}

revSoldCtp:
  TargetConditions:
    - faction{f=Somar} castInstead ReclutarSolds
  Skills:
    - msg{m="&9No objetivos"} @NearestPlayer

ReclutarSolds:
  Cooldown: 2
  Skills:
  - skill{s=MarcCatapult3} @Target
  - clearThreat @self
ctprsPerdidos:
  Cooldown: 5
  Conditions:
  - (variableEquals{var=caster.sold1;t=String;value="false"} || variableEquals{var=caster.sold2;t=String;value="false"} || variableEquals{var=caster.sold3;t=String;value="false"}) castInstead revSoldCtp
  Skills:
  #- globalcooldown{ticks=20}
  - msg{m="&9 Soldados completos"} @NearestPlayer
  - skill{s=LlamarCatapulteros} @LivingInWorld

#Procesos de catapulta con catapulteros (inicia a partir de que hay un trio de sodados)

LlamarCatapulteros:
  Conditions:
  - variableEquals{var=caster.cicloDisp;t=String;value="llamarCatapults"}
  TargetConditions:
  - isMythicMob
  - variableEquals{var=target.catapultuuid;value=<caster.uuid>}
  Skills:
  - projectile{bullet=block;material=STONE}

#soldsApuntar:
#  Skills:
#    - missile{bullet=block;material=STONE;g=-1;mr=500;Ho=100;v=10;intertia=80.0}

#AvanzarAnimation:
#  Skills:
#     - state{mid=SomarSoldier;s=animationEmpujarDerecha} @UniqueIdentifier{uuid=<caster.var.sold2>}
#     - state{mid=SomarSoldier;s=animationEmpujarIzquierda} @UniqueIdentifier{uuid=<caster.var.sold3>}

#EmpujarDerechaAnimation:
#  Skills:
#     - state{mid=SomarSoldier;s=animationEmpujarDerecha} @UniqueIdentifier{uuid=<caster.var.sold2>}

#EmpujarIzquierdaAnimation:
#  Skills:
#     - state{mid=SomarSoldier;s=animationEmpujarIzquierda} @UniqueIdentifier{uuid=<caster.var.sold3>}

#avisJugador:
#  Skills:
#    - msg{m="Se te invito a ser catapultero, en el puesto <target.var.catapulta>"} @Target
Mira:
 Skills:
    - particles{p=Electric_Spark;size=60;a=1;uel=true;forwardOffset=3;yOffset=5;vd=1} @Self
    - particles{p=flame;size=0.001;a=1;uel=true;forwardOffset=3;yOffset=9.3;vd=1;vs=0} @Ring{rotationz=8;relative=true;r=0.5;p=10}